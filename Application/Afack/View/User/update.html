<include file="Public:header"/>
<aside>
	 <ul>
        <li><a href="{:u('Index/index')}" class="backgroundColorLan">《首页</a></li>
     </ul>
</aside>
<script language=javascript> 
//测试某个字符是属于哪一类
function CharMode(iN){ 
if (iN>=48 && iN <=57) //数字 
return 1; 
if (iN>=65 && iN <=90) //大写字母 
return 2; 
if (iN>=97 && iN <=122) //小写 
return 4; 
else 
return 8;
} 
function bitTotal(num){ 
modes=0; 
for (i=0;i<4;i++){ 
if (num & 1) modes++; 
num>>>=1; 
} 
return modes; 
} 
function checkStrong(sPW){ 
if (sPW.length<=4) 
return 0;
Modes=0; 
for (i=0;i<sPW.length;i++){
Modes|=CharMode(sPW.charCodeAt(i)); 
} 
return bitTotal(Modes); 
}
function pwStrength(pwd){ 
O_color="#eeeeee"; 
L_color="#FF0000"; 
M_color="#FF9900"; 
H_color="#33CC00"; 
if (pwd==null||pwd==''){ 
Lcolor=Mcolor=Hcolor=O_color; 
} 
else{ 
S_level=checkStrong(pwd); 
switch(S_level) { 
case 0: 
Lcolor=Mcolor=Hcolor=O_color; 
case 1: 
Lcolor=L_color; 
Mcolor=Hcolor=O_color; 
break; 
case 2: 
Lcolor=Mcolor=M_color; 
Hcolor=O_color; 
break; 
default: 
Lcolor=Mcolor=Hcolor=H_color; 
} 
} 
document.getElementById("strength_L").style.background=Lcolor; 
document.getElementById("strength_M").style.background=Mcolor; 
document.getElementById("strength_H").style.background=Hcolor; 
return; 
} 
</script>
<!--内容-->
<div id="content">
     <div class="newsList">
     	  <table width="100%" border="0" cellspacing="0" cellpadding="0">
     	  <form action="{:u('User/uppwd')}" method="post">
            <tr>
            <th>修改密码</th>
              <th align="left"></th>
              <th></th>
              <th></th>
              <th></th>
            </tr>
            <tr>
              <td style="border:none;"></td>
              <td style="border:none;">用户id:</td>
              <td style="border:none;">{$_SESSION['id']}</td>
            </tr>
            <tr>
              <td style="border:none;"></td>
              <td style="border:none;">原密码:</td>
              <td style="border:none;"><input name="pwd" type="password" id="oldpassword" height="20" datatype="*5-16" nullmsg="密码不能为空" errormsg="范围5-16"></td>
              <td style="border:none; color:red;" id="tip1">{$yuanpass}</td>
            </tr>
            <script type="text/javascript">
	            $(document).ready(function(){                
	                $("#oldpassword").blur(function(){
	                        var param=$("#oldpassword").val();
	                        $.ajax({
	                        	url:"checkoldpassword",
	                            data:{oldpassword:param},                 
	                            success:function(e){
	                                if(e==1){                            
	                                     $("#tip1").html("<font color=\"green\" size=\"2\"> 密码输入正确</font>");
	                                } 
	                                else{                                 
	                                    $("#tip1").html("<font color=\"red\" size=\"2\">密码输入错误</font>");
	                                }
	                            }                 
	                        });
	                   });
	            });
            </script>
            <tr>
              <td style="border:none;"></td>
              <td style="border:none;">新密码:</td>
              <td style="border:none;"><input name="pwd1" id="pddone" type="password" height="20" datatype="*5-16" nullmsg="新密码为空" errormsg="新密码范围5-16" onKeyUp=pwStrength(this.value)  onBlur=pwStrength(this.value) ></td>
              <td style="border:none;">
              <table width="100" border="1" cellspacing="0" cellpadding="1" bordercolor="#cccccc" height="20">
			    <tr align="center" bgcolor="#eeeeee">
			      <td width="33%" style="padding:0px;" id="strength_L">弱</td>
			      <td width="33%" style="padding:0px;" id="strength_M">中</td>
			      <td width="33%" style="padding:0px;" id="strength_H">强</td>
			    </tr>
			  </table>
              </td>
    		</tr>
            <tr>
               <td style="border:none;"></td>
              <td style="border:none;">重复新密码:</td>
              <td style="border:none;"><input name="pwd2" type="password"  id="pddtwo" onblur="checktpd()" height="20" datatype="*5-16" nullmsg="新密码为空" errormsg="新密码范围5-16"></td>
              <td style="border:none; color:red;" id="pddtwotis">{$uppass}</td>
            </tr>
            <tr>
              <td style="border:none;"></td>
              <td style="border:none;" colspan="2"><center><input type="submit" value="确认提交"/></center></td>
              <td style="border:none;"></td>
            </tr>
            </form>
          </table>
     </div>
</div>
<!--尾巴-->
<footer>版权所有 违者必究</footer>
<script>
$(function(){
	$('header .nav').click(function(){
		$('nav').slideToggle(0);
		$('#content, aside').toggleClass('margin'); 
  	});
})
function checktpd()
{
	var a=$('#pddone').val();
	var b=$('#pddtwo').val();
	if(a==b){var myDivname=document.getElementById("pddtwotis");
    myDivname.innerHTML="<font color='green'>重复密码正确</font>";}
	else{
		var myDivname=document.getElementById("pddtwotis");
	    myDivname.innerHTML="<font>重复密码错误</font>";
	}
}
</script>
</body>
</html>